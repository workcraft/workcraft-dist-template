<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>tutorial:method:loop_breaking:start - Workcraft</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="theme-color" content="#008800"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="tutorial,method,loop_breaking,start"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.html" title="Workcraft"/>
<link rel="start" href="start.html"/>
<link rel="contents" href="start.html" title="Sitemap"/>
<link rel="manifest" href="../../lib/exe/manifest.html"/>
<link rel="alternate" type="application/rss+xml" title="Changes" />
<link rel="alternate" type="application/rss+xml" title="Current namespace" />
<link rel="edit" title="Edit this page" href="start.html"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../../_export/xhtml/tutorial/method/loop_breaking/start.xhtml"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="../../_export/raw/tutorial/method/loop_breaking/start.raw"/>
<link rel="canonical" href="https://workcraft.org/tutorial/method/loop_breaking/start"/>
<link rel="stylesheet" href="../../lib/exe/css.php.t.dokuwiki-light-export.css"/>
<!--[if gte IE 9]><!-->
<script >/*<![CDATA[*/var NS='tutorial:method:loop_breaking';var SIG=" --- \/\/[[support@workcraft.org| ]] 2020\/11\/24 09:02\/\/";var JSINFO = {"fastwiki":{"secedit":1,"preview":1,"fastpages":1,"save":0,"fastshow":0,"fastshow_same_ns":1,"fastshow_include":"","fastshow_exclude":"","preload":false,"preload_head":"====47hsjwycv782nwncv8b920m8bv72jmdm3929bno3b3====","preload_batchsize":false,"preload_per_page":false,"locktime":840,"usedraft":1,"text_btn_show":"Show page","templatename":"dokuwiki-light-export"},"plugin_folded":{"hide":"hide","reveal":"reveal"},"move_renameokay":true,"id":"tutorial:method:loop_breaking:start","namespace":"tutorial:method:loop_breaking","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script charset="utf-8" src="../../lib/exe/jquery.php.t.dokuwiki-light-export.js" defer="defer"></script>
<script charset="utf-8" src="../../lib/exe/js.php.t.dokuwiki-light-export.js" defer="defer"></script>
<!--<![endif]-->
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="../../favicon.ico" />
<link rel="apple-touch-icon" href="../../apple-touch-icon.png" />
    </head>

<body>
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_dokuwiki-light-export loggedIn    ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <h1><a href="../../start.html"  accesskey="" title=""><img src="../../logo.png" width="381" height="64" alt="" /></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
<!--
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li class="action profile"><a href="start.html" title="Profile" rel="nofollow"><span>Profile</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M2 3h20c1.05 0 2 .95 2 2v14c0 1.05-.95 2-2 2H2c-1.05 0-2-.95-2-2V5c0-1.05.95-2 2-2m12 3v1h8V6h-8m0 2v1h8V8h-8m0 2v1h7v-1h-7m-6 3.91C6 13.91 2 15 2 17v1h12v-1c0-2-4-3.09-6-3.09M8 6a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3z"/></svg></a></li><li class="action admin"><a href="start.html" title="Admin" rel="nofollow"><span>Admin</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 15.5A3.5 3.5 0 0 1 8.5 12 3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97 0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1 0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66z"/></svg></a></li><li class="action logout"><a href="start.html" title="Log Out" rel="nofollow"><span>Log Out</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M17 17.25V14h-7v-4h7V6.75L22.25 12 17 17.25M13 2a2 2 0 0 1 2 2v4h-2V4H4v16h9v-4h2v4a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9z"/></svg></a></li>                </ul>
            </div>
        -->
        <!-- SITE TOOLS -->
<!--
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="../../start.html" method="get" role="search" class="search doku_form" id="dw__search" accept-charset="utf-8"><input type="hidden" name="do" value="search" /><input type="hidden" name="id" value="tutorial:method:loop_breaking:start" /><div class="no"><input name="q" type="text" class="edit" title="[F]" accesskey="f" placeholder="Search" autocomplete="on" id="qsearch__in" value="" /><button value="1" type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="../..//doku.html.doku.php.html" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="tutorial:method:loop_breaking:start" /><input type="hidden" name="sectok" value="76e97b919f59bf5330d969a72ba5bf17" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Edit this page</option><option value="revisions">Old revisions</option><option value="export_pdf">Export to PDF</option><option value="menuitemfolded">Fold/unfold all</option><option value="menuitem">Rename Page</option><option value="siteexport_addpage">Export Page to HTML/PDF</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Changes</option><option value="media">Media</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="profile">Profile</option><option value="admin">Admin</option><option value="logout">Log Out</option></optgroup></select><button type="submit">&gt;</button></div></form>            </div>
            <ul>
                <li class="action recent"><a href="start.html" title="Changes [r]" rel="nofollow" accesskey="r">Changes</a></li><li class="action media"><a href="start.html" title="Media" rel="nofollow">Media</a></li><li class="action index"><a href="start.html" title="Sitemap [x]" rel="nofollow" accesskey="x">Sitemap</a></li>            </ul>
        </div>
-->
    </div>

    <!-- BREADCRUMBS -->
<!--
    -->


    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">
                
                <div class="pageId"><span>tutorial:method:loop_breaking:start</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <div class="plugin_fastwiki_marker" style="display:none"></div><!-- TOC START -->
<div id="dw__toc" class="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="#cycle_analyser">Cycle analyser</a></div></li>
<li class="level1"><div class="li"><a href="#analysis_of_combinational_cycles">Analysis of combinational cycles</a></div></li>
<li class="level1"><div class="li"><a href="#disabling_timing_arcs">Disabling timing arcs</a></div></li>
<li class="level1"><div class="li"><a href="#insertion_of_testable_buffers">Insertion of testable buffers</a></div></li>
<li class="level1"><div class="li"><a href="#verification">Verification</a></div></li>
<li class="level1"><div class="li"><a href="#solutions">Solutions</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 id="loop_breaking_and_offline_testing">Loop breaking and offline testing</h1>
<div class="level1">

<p>
In this tutorial we will use VME bus controller circuit <span class="wrap_download "><a href="vme-tm.circuit.work" class="media mediafile mf_work" title="tutorial:method:loop_breaking:vme-tm.circuit.work (6.6 KB)">vme-tm.circuit.work</a> (7 KiB)</span> and its <abbr title="Signal Transition Graph">STG</abbr> specification <span class="wrap_download "><a href="vme.stg.work" class="media mediafile mf_work" title="tutorial:method:loop_breaking:vme.stg.work (4.1 KB)">vme.stg.work</a> (4 KiB)</span> developed in the tutorial  <a href="../../design/vme_bus/start.html" class="wikilink1" title="tutorial:design:vme_bus:start" data-wiki-id="tutorial:design:vme_bus:start">Design of VME bus controller</a> – download these files into your working directory.
</p>

</div>
<div class="level1">
<div class="plugin_include_content plugin_include__help:circuit:loop_breaking" id="plugin_include__help__circuit__loop_breaking">

<h2 id="cycle_analyser">Cycle analyser</h2>

<p>
Combinational cycles are common in asynchronous circuits – they (along with latches) usually implement “memory” of the circuit. Verilog netlist for such cyclic circuits, however, may upset conventional EDA tools for timing analysis (e.g. Synopsys PrimeTime) and offline testing (e.g. Synopsys TetraMAX):
</p>
<ul>
<li class="level1"><div class="li"> Static timing analysis requires the circuit to be free of combinational cycles and breaks them by disabling some of the timing arcs. The choice of the timing arcs to disable, however, is often difficult to predict and suboptimal, and in particular may cause removal of timing paths that are important for timing analysis, e.g. critical paths.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Offline testing may also be affected by the combinational cycles as they limit the <em>controlability</em> of the circuit – the ability to set every signal to a specific state via the circuit&#039;s primary inputs.</div>
</li>
</ul>

<p>
Workcraft introduces a <em>Path breaker</em> property for the component pins to explicitly break the combinational cycles. Interpretation of this property differs for the input and output pins of a gate:
</p>
<ul>
<li class="level1"><div class="li"> For each <strong>input pin</strong> whose <em>Path breaker</em> property is set, a <code>set_disable_timing</code> constraint is generated – it disables the timing arcs from that input pin, thus removing timing paths through the pin. These constraints can be dumped into an SDC file and subsequently used to explicitly instruct a timing analysis tool to disable specific timing arcs, rather than rely on its unpredictable arc selection algorithm. Careful selection of the timing arcs for disabling may help to break all the combinational cycles in the circuit while preserving the important/interesting timing paths. This requires creativity from the designer and is not always possible.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> For each <strong>output pin</strong> whose <em>Path breaker</em> property is set, a special element called <em>testable buffer</em> or <em>testable inverter</em> is inserted. Such testable elements need to be designed and characterised for each gate library, so the timing analysis tool is aware of their path breaking capability. Moreover, the testable elements can be further extended with SCAN features, making asynchronous design compatible with conventional DfT methodology <a href="#refnotes:1:note1" name="refnotes:1:ref1" class="refnotes-ref note-popup">[1]</a>.</div>
</li>
</ul>

<p>
Note that both ways of dealing with combinational cycles can be combined in the same circuit. 
</p>

<p>
<em>Cycle analyser</em> <img src="../../../help/circuit/editor_tools-cycle_analysis.png" class="media" title="[Y] Cycle analyser" alt="[Y] Cycle analyser" /> tool provides a convenient <abbr title="Graphical User Interface">GUI</abbr> for exploration of loop breaking alternatives. It automates the removal of combinational cycles and the insertion of testing features in asynchronous circuits. <em>Cycle analyser</em> control panel looks as follows:
</p>

<p>
<img src="../../../help/circuit/tool_controls-loop_breaking.png" class="mediacenter" alt="" />
</p>

<p>
When the tool is activated, the circuit gates are highlighted using the following scheme (the colours can be adjusted in the preferences of digital circuit model – see <em>Edit→Preferences…→Decoration→Analysis</em>):
</p>
<ul>
<li class="level1"><div class="li"> Zero delay gates and their output pins are highlighted <span style='color:grey; '> grey</span>. This is to indicate that zero delay gates cannot be delayed by inserting testable buffers. Input pins of zero delay gates can still be set as path breakers though.</div>
</li>
<li class="level1"><div class="li"> Components and pins that lay on a cycle are highlighted <span style='color:magenta; '> magenta</span>.</div>
</li>
<li class="level1"><div class="li"> Pins whose <em>Path breaker</em> property is set are highlighted <span style='color:orange; '>orange</span>. Components with path breaker pins are also highlighted <span style='color:orange; '>orange</span>.</div>
</li>
<li class="level1"><div class="li"> Components and pins that do not belong to any cycle are highlighted <span style='color:lime; '>green</span>.</div>
</li>
</ul>

<p>
<em>Path breakers</em> table enumerates the pins whose <em>Path breaker</em> property is set. Note that <em>Path breaker</em> property of a pin can be toggled while in <em>Cycle analyser</em> tool by clicking the corresponding pin; clicking on a gate toggles <em>Path breaker</em> property of its only output. The change is immediately visualised via updated highlighting of components and pins. This enables convenient exploration of possible cycle breaking strategies.
</p>

<p>
<em>Cycle analyser</em> also provides several ways of changing <em>Path breaker</em> property for a group of output pins (input pins are not affected by these actions):
</p>
<ul>
<li class="level1"><div class="li"> <img src="../../../help/circuit/tool_controls-loop_breaking-self_loop.png" class="media" title="Path breaker all self loops" alt="Path breaker all self loops" /> - Tag <em>Path breaker</em> property for output pins of components with feedback loops. Note that feedback loops via zero-delay inverters or buffers are also included.</div>
</li>
<li class="level1"><div class="li"> <img src="../../../help/circuit/tool_controls-loop_breaking-tag_necessary.png" class="media" title="Auto-append path breaker pins as necessary to complete cycle breaking" alt="Auto-append path breaker pins as necessary to complete cycle breaking" /> - Set <em>Path breaker</em> property of output pins as necessary to break all the cycles in the circuit.</div>
</li>
<li class="level1"><div class="li"> <img src="../../../help/circuit/tool_controls-loop_breaking-untag_redundant.png" class="media" title="Auto-discard path breaker pins that are redundant for cycle breaking" alt="Auto-discard path breaker pins that are redundant for cycle breaking" /> - Clear <em>Path breaker</em> property of output pins that are redundant for breaking all cycles in the circuit.</div>
</li>
<li class="level1"><div class="li"> <img src="../../../help/circuit/tool_controls-loop_breaking-clear_all.png" class="media" title="Clear all path breaker pins" alt="Clear all path breaker pins" /> - Clear <em>Path breaker</em> property for all the pins.</div>
</li>
</ul>

<p>
Once all the cycles are broken by strategically assigning the <em>Path breaker</em> property to the pins, the buttons at the bottom of the tool panel are used as follows:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Insert TBUF/TINV</strong>  – insert testable buffers/inverters after output pins with <em>Path breaker</em> property set. Note that insertion of testable buffers is optimised as follows: If the path breaker pin belongs to a buffer (inverter), or if the only gate it drives is a buffer (inverter), then, instead of inserting a new testable gate, that buffer (inverter) is converted into the testable buffer(testable inverter).</div>
</li>
</ul>
<div class="wrap_info wrap_round wrap_center plugin_wrap" style="width: 90%;">
<p>
By default the testable buffer gate is <code>TBUF</code> with input <code>I</code> and output <code>O</code>; testable inverter gate is <code>TINV</code> with <code>I</code> and <code>ON</code> pins. These names can be changed in <em>Edit→Preferences…→Models→Digital Circuit</em> preferences via <em>Testable buffer name and input-output pins</em> and <em>Testable inverter name and input-output pins</em> settings.
</p>
</div><ul>
<li class="level1"><div class="li"> <strong>Insert SCAN</strong> – insert SCAN ports and connect them to the <em>testable buffers</em>.</div>
</li>
</ul>
<div class="wrap_info wrap_round wrap_center plugin_wrap" style="width: 90%;">
<p>
When connecting a gate to scan ports its module name is automatically changed by adding <code>_SCAN</code> suffix. This default suffix can be changed in <em>Edit→Preferences…→Models→Digital Circuit</em> preferences via <em>Scan module suffix</em> setting. By default SCAN primary inputs are called <code>scanck</code>, <code>scanen</code>, <code>scanin</code>, and <code>scanout</code> while the corresponding pins of testable gates are <code>CK</code>, <code>SE</code>, <code>SI</code>, and <code>SO</code> (the latter is only used in multi-output components). These names can also be changed in <em>Edit→Preferences…→Models→Digital Circuit</em> preferences via <em>Scan clock port / pin names</em>, <em>Scan enable port / pin names</em>, <em>Scan input port / pin names</em> and <em>Scan output poert / pin (for multi-output component) names</em> settings.
</p>
</div><ul>
<li class="level1"><div class="li"> <strong>Write SDC…</strong> – write out an SDC file with <code>set_disable_timing</code> constraints for each input pin with <em>Path breaker</em> property set. This button is disabled if there are no input pins with <em>Path breaker</em> property set.</div>
</li>
</ul>
<div class="wrap_info wrap_round wrap_center plugin_wrap" style="width: 90%;">
<p>
By default the produced SDC file uses the names of gates and pins as they are defined in the <em>Property editor</em> for the corresponding nodes. If necessary, these names can be substituted by providing a conversion file in <em>Edit→Preferences…→Models→Digital Circuit</em> preferences via <em>Substitution rules for export</em> setting. For example, <code>libraries/workcraft-tsmc_ghp.cnv</code> file has rules to convert <code>libraries/workcraft.lib</code> gates to match the naming convention of TSMC GHP library. This is a convenient way to convert a circuit (and its constraints) mapped into one gate library to be used with another library.
</p>
</div>

<div class="refnotes">
<hr>
<div class="notes">
<div class="note left">
<b><a name="refnotes:1:note1" class="nolink">[1]</a></b>
<span id="refnotes:1:note1:text">
D. Lloyd, R. Illman: <em>“Scan insertion and ATPG for C-gate based
asynchronous designs”</em>, in Synopsys User Group (SNUG), 2014.
</span></div>
</div>
</div>
</div>

</div>

<h2 id="analysis_of_combinational_cycles">Analysis of combinational cycles</h2>
<div class="level2">

<p>
Open VME bus controller circuit and activate <em>Cycle analyser</em> <img src="../../../help/circuit/editor_tools-cycle_analysis.png" class="media" title="[Y] Cycle analyser" alt="[Y] Cycle analyser" /> tool. Most of the gates are highlighted <span style='color:magenta; '>magenta</span> indicating that they belong to some combinational cycles:
</p>

<p>
<img src="vme-tm-cycle_analysis.circuit.png" class="mediacenter" title="Cycle analysis of VME bus controller" alt="Cycle analysis of VME bus controller" />
</p>

<p>
If we would pass this circuit to a static timing analysis tool, it would likely disable the timing arc in gate <code>OUT_BUBBLE15</code> to eliminate all the cycles. While this is may look like an optimal solution, unfortunately it also removes many important timing paths, e.g. one would not be able to measure the critical delays from <code><span style='color:red; '>dsr</span></code> and from <code><span style='color:red; '>dsw</span></code> to <code><span style='color:blue; '>lds</span></code>. Therefore, other methods of dealing with combinational cycles are required.
</p>

</div>

<h2 id="disabling_timing_arcs">Disabling timing arcs</h2>
<div class="level2">

<p>
As a first exercise, experiment with tagging input pins in VME bus controller as path breakers, trying to eliminate all the combinational cycles. At the same time make sure to preserve all interesting and important timing paths.
</p>

<p>
For example, if we assume that feedback loops are always short and do not require timing analysis, then the self-loop input pin of gate <code>U17</code> is an obvious candidate for breaking a cycle. The input of <code>U16</code> that is driven by a zero delay inverter is another candidate for path breaking as it is not on a critical path. (Alternatively the timing arc in the preceding zero delay inverter can be disabled.) Click both these input pins to set their <em>Path breaker</em> property. The result should look as follows:
</p>

<p>
<img src="vme-tm-break_timing_arcs-selfloops.circuit.png" class="mediacenter" title="Breaking self-loop timing arcs in VME circuit" alt="Breaking self-loop timing arcs in VME circuit" />
</p>

<p>
It may be tempting to tag the remaining pin on the cycle in gate <code>U16</code> as a path breaker, and this indeed would eliminate all the cycles. However, this would also break an important path from <code><span style='color:blue; '>d</span></code> to <code><span style='color:blue; '>lds</span></code> while, according to the specification of VME bus controller, <code><span style='color:blue; '>d</span></code> is a trigger of <code><span style='color:blue; '>lds</span></code> (see  the causality arc <code><span style='color:blue; '>d+</span>→<span style='color:blue; '>lds+</span></code> in the <abbr title="Signal Transition Graph">STG</abbr> below):
</p>

<p>
<img src="vme.stg.svg" width="208" height="300" class="svgscaleinsert mediacenter" alt="tutorial:method:loop_breaking:vme.stg.svg">
</p>

<p>
Instead, consider input pins in gates <code>U1</code> and  <code>U5</code> that are on a cycle. These are driven by context signals as all the triggers of  output <code><span style='color:blue; '>d</span></code> are primary inputs of the circuit. Therefore the timing paths through this arcs are not critical and the timing arcs from these pins can be safely disabled – click both pins to set their <em>Path breaker</em> property. Now all the gates are highlighted <span style='color:lime; '>green</span> indicating that there is no more unbroken combinational cycles in the circuit:
</p>

<p>
<img src="vme-tm-break_timing_arcs-complete.circuit.png" class="mediacenter" title="Breaking timing arcs in VME circuit" alt="Breaking timing arcs in VME circuit" />
</p>

<p>
The information about disabled timing arcs can now be exported as a set of SDC constraints for subsequent use in the conventional EDA tools – click on the <code>Write SDC…</code> button and save the constraints in <code>vme-tm.circuit.sdc</code> file, which will be as follows:
</p>
<dl class="file">
<dt><a href="../../_export/code/tutorial/method/loop_breaking/start/codeblock.0.code" title="Download Snippet" class="mediafile mf_sdc">vme-tm.circuit.sdc</a></dt>
<dd><pre class="code file tcl"><span class="co1"># Path break SDC file generated by Workcraft 3 (Return of the Hazard), version 3.2.4</span>
set_disable_timing U1 -from AN -to ON
set_disable_timing U5 -from A2 -to ON
set_disable_timing U16 -from A1 -to ON
set_disable_timing U17 -from A2N -to ON</pre>
</dd></dl>

</div>

<h2 id="insertion_of_testable_buffers">Insertion of testable buffers</h2>
<div class="level2">

<p>
Let us now use a different approach to loop breaking and insert testable buffers in every combinational cycle. For this, activate <em>Cycle analyser</em> <img src="../../../help/circuit/editor_tools-cycle_analysis.png" class="media" title="[Y] Cycle analyser" alt="[Y] Cycle analyser" /> tool and clear <em>Path breaker</em> properties from all the pins by pressing <img src="../../../help/circuit/tool_controls-loop_breaking-clear_all.png" class="media" title="Clear all path breaker pins" alt="Clear all path breaker pins" /> button.
</p>

<p>
All the components and pins on a cycle are highlighted <span style='color:magenta; '>magenta</span>. The challenge is to eliminate all the cycles by setting <em>Path breaker</em> property of as few output pins as possible. You can try to do this manually by clicking the output pins to toggle their <em>Path breaker</em> property – path breaker pins and components will turn <span style='color:orange; '>orange</span> and the ones that become not on a cycle turn <span style='color:lime; '>green</span>.
</p>

<p>
You can also rely on the <em>automatic</em> loop breaking: press <img src="../../../help/circuit/tool_controls-loop_breaking-tag_necessary.png" class="media" title="Auto-append path breaker pins as necessary to complete cycle breaking" alt="Auto-append path breaker pins as necessary to complete cycle breaking" /> for eliminating all the remaining cycles or <img src="../../../help/circuit/tool_controls-loop_breaking-untag_redundant.png" class="media" title="Auto-discard path breaker pins that are redundant for cycle breaking" alt="Auto-discard path breaker pins that are redundant for cycle breaking" /> for discarding redundant path breaker pins.
</p>

<p>
Interestingly, setting <em>Path breaker</em> property for the output pin of a single gate <code>U17</code> is sufficient to eliminate all the combinational cycles:
</p>

<p>
<img src="vme-tm-break_self_loops.circuit.png" class="mediacenter" title="Breaking self-loops in VME bus controller" alt="Breaking self-loops in VME bus controller" />
</p>

<p>
Now insert a testable buffer at the output of <code>U17</code> by pressing <strong>Insetr TBUF/TINV</strong> button:
</p>

<p>
<img src="vme-tm-tbuf.circuit.png" class="mediacenter" title="Insertion of testable buffers in VME bus controller" alt="Insertion of testable buffers in VME bus controller" />
</p>

<p>
Usually a custom SCAN insertion script is employed at this stage  for replacing <code>TBUF</code> and <code>TINV</code> gates by specialised SCAN-enabled components and arranging them into the SCAN chain. A basic alternative to such procedure is implemented in Workcraft. Pressing the <strong>Insert SCAN</strong> button automatically creates the SCAN chain  following a sequence of steps (the names of SCAN ports and pins can be changed in <em>Edit→Preferences…→Models→Digital Circuit</em> preferences):
</p>
<ol>
<li class="level1"><div class="li"> Add SCAN ports <code><span style='color:red; '>scanck</span></code>, <code><span style='color:red; '>scanen</span></code>, <code><span style='color:red; '>scantm</span></code>, <code><span style='color:red; '>scanin</span></code>, and <code><span style='color:blue; '>scanout</span></code>.</div>
</li>
<li class="level1"><div class="li"> Convert <code>TBUF</code> and <code>TINV</code> components into their SCAN-enabled alternatives <code>TBUF_SCAN</code> and <code>TINV_SCAN</code>, respectively, with additional <code><span style='color:red; '>CK</span></code>, <code><span style='color:red; '>SE</span></code>, and <code><span style='color:red; '>SI</span></code> pins.</div>
</li>
<li class="level1"><div class="li"> Connect <code><span style='color:red; '>scanck</span></code>, <code><span style='color:red; '>scanen</span></code> and <code><span style='color:red; '>scantm</span></code> ports to <code><span style='color:red; '>CK</span></code>, <code><span style='color:red; '>SE</span></code> and <code><span style='color:red; '>TM</span></code> pins of testable components, respectively.</div>
</li>
<li class="level1"><div class="li"> Arrange testable components in the SCAN chain between <code><span style='color:red; '>scanin</span></code> and <code><span style='color:blue; '>scanout</span></code> ports.</div>
</li>
</ol>

<p>
The final VME bus controller with SCAN should look as follows:
</p>

<p>
<img src="vme-tm-scan.circuit.png" class="mediacenter" title="Insertion of SCAN in VME bus controller" alt="Insertion of SCAN in VME bus controller" />
</p>

<p>
Note that disabling timing arcs and generation of SDC file can be combined with insertion of testable elements if necessary.
</p>

</div>

<h2 id="verification">Verification</h2>
<div class="level2">

<p>
Insertion of testable buffers and SCAN should not break the circuit. This can be verified in a usual way via <em>Verification</em> menu using the original <abbr title="Signal Transition Graph">STG</abbr> as the environment for the modified circuit – all the standard verification properties, namely <em>Conformation</em>, <em>Deadlock freeness</em>, and <em>Output persistency</em> should pass.
</p>

<p>
Note that the will be warnings about unused <code><span style='color:blue; '>scanout</span></code> output and about dead places associated with <code><span style='color:red; '>scanck</span></code>, <code><span style='color:red; '>scanen</span></code>, <code><span style='color:red; '>scantm</span></code>, <code><span style='color:red; '>scanin</span></code> ports. Both warnings are expected and can be safely ignored. Indeed, the behaviour of SCAN output is not specified in the <em>mission-mode</em> <abbr title="Signal Transition Graph">STG</abbr>, and all the SCAN input ports are intentionally forced low, i.e. their <em>Init to one</em> property is unset and their <em>Set function</em> is assigned to constant <code>0</code>.
</p>

</div>

<h2 id="solutions">Solutions</h2>
<div class="level2">

<p>
Download all the Workcraft models discussed in this tutorial here:
</p>

<p>
<span class="wrap_download "><a href="loop_breaking.zip" class="media mediafile mf_zip" title="tutorial:method:loop_breaking:loop_breaking.zip (32 KB)">Circuit models</a> (32 KiB)</span>
</p>

</div>
<div class="level1">
<div class="plugin_include_content plugin_include__tutorial:feedback" id="plugin_include__tutorial__feedback">
<div class="wrap_hide plugin_wrap"><pre class="code">===== Feedback =====</pre>
<form class="bureaucracy__plugin" id="bureaucracy__plugin1" enctype="multipart/form-data" method="post" action="start.html" accept-charset="utf-8"><div class="no">
<input type="hidden" name="sectok" value="76e97b919f59bf5330d969a72ba5bf17" /><input type="hidden" name="id" value="tutorial:method:loop_breaking:start" /><input type="hidden" name="bureaucracy[$$id]" value="1" /><fieldset ><legend>Comments or suggestions for improving this tutorial</legend>
<label><span>Name (optional)</span> <input type="text" name="bureaucracy[1]" class="edit" /></label>
<label><span>Email (optional)</span> <input type="text" name="bureaucracy[2]" class="edit" /></label>
<label class=" textareafield">
    <span>Feedback <sup>*</sup></span>
    <textarea name="bureaucracy[3]" id="" rows="10" cols="10" class="edit required&quot; required=&quot;required"></textarea>
</label><button type="submit">Submit</button>
</fieldset>
</div></form>
</div><div class="wrap_hide plugin_wrap"><ul>
<li class="level1"><div class="li"> As discussed in <a href="https://www.dokuwiki.org/plugin:include#controlling_header_size_in_included_pages" class="urlextern" title="https://www.dokuwiki.org/plugin:include#controlling_header_size_in_included_pages" rel="ugc nofollow">https://www.dokuwiki.org/plugin:include#controlling_header_size_in_included_pages</a>, by default, the headers in included pages start one level lower than the last header in the current page. This can be tweaked by adding an empty header above the include:\\<pre class="code">====== ======
{{page&gt;:tutorial:feedback&amp;inline}}</pre>
</div>
</li>
<li class="level1"><div class="li"> For offline help generation the content of <code>feedback</code> page should be temporary wrapped in <code>&lt;WRAP hide&gt;</code>. Note that the headers still propagate to the table of contents even if inside the hidden wrap. Therefore the <strong>Feedback</strong> title needs to be converted to something else, e.g. to code by adding two spaces in front.</div>
</li>
</ul>
</div></div>

</div>

                    <!-- wikipage stop -->
                                    </div>
<!--
                <div class="docInfo">
                    workcraft @ <bdi>tutorial/method/loop_breaking/start.txt</bdi> · Modified 2020/04/01 16:49 by <bdi>danil</bdi>                </div>
-->
                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
<!--
            <div id="dokuwiki__pagetools">
                            <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li class="edit"><a href="start.html" title="Edit this page [e]" rel="nofollow" accesskey="e"><span>Edit this page</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg></a></li><li class="revs"><a href="start.html" title="Old revisions [o]" rel="nofollow" accesskey="o"><span>Old revisions</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M11 7v5.11l4.71 2.79.79-1.28-4-2.37V7m0-5C8.97 2 5.91 3.92 4.27 6.77L2 4.5V11h6.5L5.75 8.25C6.96 5.73 9.5 4 12.5 4a7.5 7.5 0 0 1 7.5 7.5 7.5 7.5 0 0 1-7.5 7.5c-3.27 0-6.03-2.09-7.06-5h-2.1c1.1 4.03 4.77 7 9.16 7 5.24 0 9.5-4.25 9.5-9.5A9.5 9.5 0 0 0 12.5 2z"/></svg></a></li><li class="backlink"><a href="start.html" title="Backlinks" rel="nofollow"><span>Backlinks</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M10.59 13.41c.41.39.41 1.03 0 1.42-.39.39-1.03.39-1.42 0a5.003 5.003 0 0 1 0-7.07l3.54-3.54a5.003 5.003 0 0 1 7.07 0 5.003 5.003 0 0 1 0 7.07l-1.49 1.49c.01-.82-.12-1.64-.4-2.42l.47-.48a2.982 2.982 0 0 0 0-4.24 2.982 2.982 0 0 0-4.24 0l-3.53 3.53a2.982 2.982 0 0 0 0 4.24m2.82-4.24c.39-.39 1.03-.39 1.42 0a5.003 5.003 0 0 1 0 7.07l-3.54 3.54a5.003 5.003 0 0 1-7.07 0 5.003 5.003 0 0 1 0-7.07l1.49-1.49c-.01.82.12 1.64.4 2.43l-.47.47a2.982 2.982 0 0 0 0 4.24 2.982 2.982 0 0 0 4.24 0l3.53-3.53a2.982 2.982 0 0 0 0-4.24.973.973 0 0 1 0-1.42z"/></svg></a></li><li class="export_pdf"><a href="start.html" title="Export to PDF" rel="nofollow"><span>Export to PDF</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M14 9h5.5L14 3.5V9M7 2h8l6 6v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m4.93 10.44c.41.9.93 1.64 1.53 2.15l.41.32c-.87.16-2.07.44-3.34.93l-.11.04.5-1.04c.45-.87.78-1.66 1.01-2.4m6.48 3.81c.18-.18.27-.41.28-.66.03-.2-.02-.39-.12-.55-.29-.47-1.04-.69-2.28-.69l-1.29.07-.87-.58c-.63-.52-1.2-1.43-1.6-2.56l.04-.14c.33-1.33.64-2.94-.02-3.6a.853.853 0 0 0-.61-.24h-.24c-.37 0-.7.39-.79.77-.37 1.33-.15 2.06.22 3.27v.01c-.25.88-.57 1.9-1.08 2.93l-.96 1.8-.89.49c-1.2.75-1.77 1.59-1.88 2.12-.04.19-.02.36.05.54l.03.05.48.31.44.11c.81 0 1.73-.95 2.97-3.07l.18-.07c1.03-.33 2.31-.56 4.03-.75 1.03.51 2.24.74 3 .74.44 0 .74-.11.91-.3m-.41-.71l.09.11c-.01.1-.04.11-.09.13h-.04l-.19.02c-.46 0-1.17-.19-1.9-.51.09-.1.13-.1.23-.1 1.4 0 1.8.25 1.9.35M8.83 17c-.65 1.19-1.24 1.85-1.69 2 .05-.38.5-1.04 1.21-1.69l.48-.31m3.02-6.91c-.23-.9-.24-1.63-.07-2.05l.07-.12.15.05c.17.24.19.56.09 1.1l-.03.16-.16.82-.05.04z"/></svg></a></li><li class="menuitemfolded"><a href="javascript:void(0);" title="Fold/unfold all" rel="nofollow" class="fold_unfold_all_new" onclick="fold_unfold_all();"><span>Fold/unfold all</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M 2,0 L 6.5,3 L 2,6 z M 8,6.6 L 12.5,9.6 L 8,12.6 z M 14,13.2 L 20,13.2 L 17,17.7 z"/></svg></a></li><li class="menuitem"><a href="start.html" title="Rename Page" rel="nofollow" class=" plugin_move_page "><span>Rename Page</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M18,4V3A1,1 0 0,0 17,2H5A1,1 0 0,0 4,3V7A1,1 0 0,0 5,8H17A1,1 0 0,0 18,7V6H19V10H9V21A1,1 0 0,0 10,22H12A1,1 0 0,0 13,21V12H21V4H18Z" /></svg></a></li><li class="siteexport_addpage"><a href="start.html" title="Export Page to HTML/PDF" rel="nofollow"><span>Export Page to HTML/PDF</span><svg width="61px" height="51px" viewBox="0 0 61 51" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><path d="M26.1891503,39.0065635 L26.0876578,38.9773206 L60.6523866,1.23972885 L60.4321374,2.11844376 L60.476442,2.07071678 L60.4265202,2.14085429 L49.5024876,45.7237994 L32.8255882,40.9187101 L26,50.508302 L26,39.2103249 L26.1891503,39.0065635 Z M60.9727675,0.862917243 L22.2676619,38.2155059 L-0.00245042233,30.2214566 L60.9727675,0.862917243 Z" id="Paper-Plane"></path></svg></a></li><li class="top"><a href="#dokuwiki__top" title="Back to top [t]" rel="nofollow" accesskey="t"><span>Back to top</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg></a></li>                    </ul>
                </div>
                        </div>
-->
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<!--
<div id="dokuwiki__footer"><div class="pad">
    
    <div class="buttons">
                <a href="https://www.dokuwiki.org/donate" title="Donate" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="https://php.net" title="Powered by PHP" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="../../check/referer" title="Valid HTML5" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="../../css-validator/check/referer.fe4c581d16fb9f59f07485ddb441e467" title="Valid CSS" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="https://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-dw.png" width="80" height="15"
            alt="Driven by DokuWiki" /></a>
    </div>
</div></div>
-->
    </div></div><!-- /site -->

    <div class="no"><img src="../../lib/exe/taskrunner.70600f7048cc081681106c5aa9050cb3.gif" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div></body>
</html>
