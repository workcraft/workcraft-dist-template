<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>tutorial:method:technology_mapping:start - Workcraft</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="theme-color" content="#008800"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="tutorial,method,technology_mapping,start"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.html" title="Workcraft"/>
<link rel="start" href="start.html"/>
<link rel="contents" href="start.html" title="Sitemap"/>
<link rel="manifest" href="../../lib/exe/manifest.html"/>
<link rel="alternate" type="application/rss+xml" title="Changes" />
<link rel="alternate" type="application/rss+xml" title="Current namespace" />
<link rel="edit" title="Edit this page" href="start.html"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../../_export/xhtml/tutorial/method/technology_mapping/start.xhtml"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="../../_export/raw/tutorial/method/technology_mapping/start.raw"/>
<link rel="canonical" href="https://workcraft.org/tutorial/method/technology_mapping/start"/>
<link rel="stylesheet" href="../../lib/exe/css.php.t.dokuwiki-light-export.css"/>
<!--[if gte IE 9]><!-->
<script >/*<![CDATA[*/var NS='tutorial:method:technology_mapping';var SIG=" --- \/\/[[support@workcraft.org| ]] 2022\/07\/19 19:43\/\/";var JSINFO = {"fastwiki":{"secedit":1,"preview":1,"fastpages":1,"save":0,"fastshow":0,"fastshow_same_ns":1,"fastshow_include":"","fastshow_exclude":"","preload":false,"preload_head":"====47hsjwycv782nwncv8b920m8bv72jmdm3929bno3b3====","preload_batchsize":false,"preload_per_page":false,"locktime":840,"usedraft":1,"text_btn_show":"Show page","templatename":"dokuwiki-light-export"},"plugin_folded":{"hide":"hide","reveal":"reveal"},"move_renameokay":true,"plugins":{"vshare":{"youtube":"youtube\\.com\/.*[&?]v=([a-z0-9_\\-]+)","vimeo":"vimeo\\.com\\\/(\\d+)","slideshare":"slideshare.*id=(\\d+)","dailymotion":"dailymotion\\.com\/video\/([a-z0-9]+)","archiveorg":"archive\\.org\/(?:embed|details)\/([a-zA-Z0-9_\\-]+)","soundcloud":"soundcloud\\.com\/([\\w-]+\/[\\w-]+)","niconico":"nicovideo\\.jp\/watch\/(sm[0-9]+)","bitchute":"bitchute\\.com\\\/video\\\/([a-zA-Z0-9_\\-]+)","coub":"coub\\.com\\\/view\\\/([a-zA-Z0-9_\\-]+)","odysee":"odysee\\.com\/\\$\/(?:embed|download)\/([-%_?=\/a-zA-Z0-9]+)","youku":"v\\.youku\\.com\/v_show\/id_([0-9A-Za-z=]+)\\.html","bilibili":"bilibili\\.com\\\/video\\\/(BV[0-9A-Za-z]+)","msoffice":"(?:office\\.com.*[&?]videoid=([a-z0-9\\-]+))","msstream":"microsoftstream\\.com\\\/video\\\/([a-f0-9\\-]{36})"}},"id":"tutorial:method:technology_mapping:start","namespace":"tutorial:method:technology_mapping","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script charset="utf-8" src="../../lib/exe/jquery.php.t.dokuwiki-light-export.js" defer="defer"></script>
<script charset="utf-8" src="../../lib/exe/js.php.t.dokuwiki-light-export.js" defer="defer"></script>
<!--<![endif]-->
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="../../favicon.ico" />
<link rel="apple-touch-icon" href="../../apple-touch-icon.png" />
    </head>

<body>
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_dokuwiki-light-export loggedIn    ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <h1><a href="../../start.html"  accesskey="" title=""><img src="../../logo.png" width="381" height="64" alt="" /></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
<!--
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li class="action profile"><a href="start.html" title="Profile" rel="nofollow"><span>Profile</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M2 3h20c1.05 0 2 .95 2 2v14c0 1.05-.95 2-2 2H2c-1.05 0-2-.95-2-2V5c0-1.05.95-2 2-2m12 3v1h8V6h-8m0 2v1h8V8h-8m0 2v1h7v-1h-7m-6 3.91C6 13.91 2 15 2 17v1h12v-1c0-2-4-3.09-6-3.09M8 6a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3z"/></svg></a></li><li class="action admin"><a href="start.html" title="Admin" rel="nofollow"><span>Admin</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 15.5A3.5 3.5 0 0 1 8.5 12 3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97 0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1 0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66z"/></svg></a></li><li class="action logout"><a href="start.html" title="Log Out" rel="nofollow"><span>Log Out</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M17 17.25V14h-7v-4h7V6.75L22.25 12 17 17.25M13 2a2 2 0 0 1 2 2v4h-2V4H4v16h9v-4h2v4a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9z"/></svg></a></li>                </ul>
            </div>
        -->
        <!-- SITE TOOLS -->
<!--
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
            <form action="../../start.html" method="get" role="search" class="search doku_form" id="dw__search" accept-charset="utf-8"><input type="hidden" name="do" value="search" /><input type="hidden" name="id" value="tutorial:method:technology_mapping:start" /><div class="no"><input name="q" type="text" class="edit" title="[F]" accesskey="f" placeholder="Search" autocomplete="on" id="qsearch__in" value="" /><button value="1" type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="../..//doku.html.doku.php.html" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="tutorial:method:technology_mapping:start" /><input type="hidden" name="sectok" value="f9e2bfe14be3555a5d08b7b3937392ae" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Edit this page</option><option value="revisions">Old revisions</option><option value="export_pdf">Export to PDF</option><option value="menuitemfolded">Fold/unfold all</option><option value="menuitem">Rename Page</option><option value="siteexport_addpage">Export Page to HTML/PDF</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Changes</option><option value="media">Media</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="profile">Profile</option><option value="admin">Admin</option><option value="logout">Log Out</option></optgroup></select><button type="submit">&gt;</button></div></form>            </div>
            <ul>
                <li class="action recent"><a href="start.html" title="Changes [r]" rel="nofollow" accesskey="r">Changes</a></li><li class="action media"><a href="start.html" title="Media" rel="nofollow">Media</a></li><li class="action index"><a href="start.html" title="Sitemap [x]" rel="nofollow" accesskey="x">Sitemap</a></li>            </ul>
        </div>
-->
    </div>

    <!-- BREADCRUMBS -->
<!--
    -->


    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">
                
                <div class="pageId"><span>tutorial:method:technology_mapping:start</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <div class="plugin_fastwiki_marker" style="display:none"></div><!-- TOC START -->
<div id="dw__toc" class="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="#examplevme_bus_controller_read_phase">Example: VME bus controller (read phase)</a></div></li>
<li class="level1"><div class="li"><a href="#overcoming_technology_mapping_failure">Overcoming technology mapping failure</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#hierarchical_design">Hierarchical design</a></div></li>
<li class="level2"><div class="li"><a href="#expanding_the_gate_library">Expanding the gate library</a></div></li>
<li class="level2"><div class="li"><a href="#insertion_of_helper_internal_signals">Insertion of helper internal signals</a></div></li>
<li class="level2"><div class="li"><a href="#simplifying_stg_structure">Simplifying STG structure</a></div></li>
<li class="level2"><div class="li"><a href="#stg_re-synthesis">STG re-synthesis</a></div></li>
<li class="level2"><div class="li"><a href="#concurrency_reduction">Concurrency reduction</a></div></li>
<li class="level2"><div class="li"><a href="#stg_decomposition">STG decomposition</a></div></li>
<li class="level2"><div class="li"><a href="#non-speed-independent_decomposition_with_relative_timing_assumptions">Non-speed-independent decomposition with relative timing assumptions</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="#solutions">Solutions</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 id="logic_decomposition_and_technology_mapping">Logic decomposition and technology mapping</h1>
<div class="level1">
<div class="wrap_center wrap_round wrap_important plugin_wrap" style="width: 70%;"><ul>
<li class="level1"><div class="li"> Before starting this tutorial you are strongly recommended to complete the <a href="../csc_resolution/start.html" class="wikilink1" title="tutorial:method:csc_resolution:start" data-wiki-id="tutorial:method:csc_resolution:start">Resolution of encoding (CSC) conflicts</a> one.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> For this tutorial you will need several example models open in Workcraft; you can download them either as a single <a href="tech_mapping.zip" class="media mediafile mf_zip" title="tutorial:method:technology_mapping:tech_mapping.zip (61.9 KB)">*.zip archive</a> (62 KiB) or individually, when reaching the concrete example.</div>
</li>
</ul>
</div>
<p>
<em>Logic decomposition</em> is the process of breaking up large complex-gates into smaller ones, e.g. replacing a 3-inputs AND gate with a pair of 2-inputs AND gates. Note that in contrast to synchronous circuits where Boolean equivalence is sufficient to guarantee the correctness of logic decomposition, for asynchronous circuits it is insufficient – e.g. the described decomposition of an AND gate may break the circuit.
</p>

<p>
<em>Technology mapping</em> is the process of assigning gates from a gate library to implement “abstract” (given as Boolean functions) gates of the circuit.
</p>

<p>
In Workcraft, logic decomposition and technology mapping are always performed together and are combined with synthesis. That is, given an <abbr title="Signal Transition Graph">STG</abbr>, Workcraft can:
</p>
<ol>
<li class="level1"><div class="li"> synthesise it</div>
</li>
<li class="level1"><div class="li"> break up complex gates</div>
</li>
<li class="level1"><div class="li"> map them to the gate library</div>
</li>
</ol>

<p>
as a single action, via the <em>Synthesis→Technology mapping [MPSat]</em> or <em>Synthesis→Technology mapping [Petrify]</em> menu entries. In the rest of this tutorial, the term <em>technology mapping</em> will be used as a short-cut for “synthesis, logic decomposition and technology mapping”.
</p>
<div class="wrap_center wrap_round wrap_important plugin_wrap" style="width: 90%;">
<p>
Technology mapping in the context of asynchronous circuits is a complicated process that can fail. In fact, it is an open problem whether every complex-gates synthesisable <abbr title="Signal Transition Graph">STG</abbr> can always be mapped to a fixed finite gate library (e.g. all gates with up to 2 inputs), and it is strongly suspected that the answer is negative. In practice, Petrify and MPSat back-ends deploy various heuristics to decompose the circuit, and occasionally fail.
</p>
</div>
<p>
This tutorial gives an introduction to technology mapping in Workcraft, and presents some techniques and tricks the designer can use to help the tool to succeed and produce a better circuit.
</p>

</div>

<h2 id="examplevme_bus_controller_read_phase">Example: VME bus controller (read phase)</h2>
<div class="level2">

<p>
Consider the following <abbr title="Signal Transition Graph">STG</abbr> modelling the read phase of the VME bus controller (a more complete version of VME bus controller can be found in <a href="../../design/vme_bus/start.html" class="wikilink1" title="tutorial:design:vme_bus:start" data-wiki-id="tutorial:design:vme_bus:start">Synthesis and verification of VME bus controller</a> tutorial). Note that the CSC conflicts in this <abbr title="Signal Transition Graph">STG</abbr> have already been resolved with the help of internal signal <code><span style='color:green; '>csc</span></code>.
</p>
<div class="wrap_center plugin_wrap"><div class="table sectionedit7"><table class="inline">
	<tr class="row0">
		<td class="col0"> <img src="vme-read-csc.stg.svg" width="625" height="93" class="svgscaleinsert mediacenter" alt="tutorial:method:technology_mapping:vme-read-csc.stg.svg"> </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  <abbr title="Signal Transition Graph">STG</abbr> for read phase of VME bus controller with resolved CSC conflict<br/>
<span class="wrap_download "><a href="vme-read-csc.stg.work" class="media mediafile mf_work" title="tutorial:method:technology_mapping:vme-read-csc.stg.work (3.2 KB)">vme-read-csc.stg.work</a> (3 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_center wrap_round wrap_info plugin_wrap" style="width: 90%;">
<p>
Petrify back-end does not require CSC conflicts to be resolved, and if one attempts to synthesise the circuit with CSC conflicts, it tries to resolve them before proceeding with the synthesis. However, MPSat back-end does require CSC conflicts to be resolved prior to synthesis, and fails if the <abbr title="Signal Transition Graph">STG</abbr> has CSC conflicts. One can verify if an <abbr title="Signal Transition Graph">STG</abbr> has CSC conflicts via <em>Verification→Complete State Coding (all cores) [MPSat]</em>. CSC conflicts can be resolved, either automatically via <em>Tools→Encoding Conflicts→…</em> or manually, see <a href="../csc_resolution/start.html" class="wikilink1" title="tutorial:method:csc_resolution:start" data-wiki-id="tutorial:method:csc_resolution:start">Resolution of encoding (CSC) conflicts</a> tutorial.
</p>
</div>
<p>
This <abbr title="Signal Transition Graph">STG</abbr> can be synthesised using complex-gates, via <em>Synthesis→Complex gate […]</em>, and the resulting circuit is as follows (after manual layouting):
</p>
<div class="wrap_center plugin_wrap"><div class="table sectionedit12"><table class="inline">
	<tr class="row0">
		<td class="col0"> <img src="vme-read-csc.circuit.svg" width="271" height="146" class="svgscaleinsert mediacenter" alt="tutorial:method:technology_mapping:vme-read-csc.circuit.svg"> </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  Complex-gate implementation<br/>
<span class="wrap_download "><a href="vme-read-csc.circuit.work" class="media mediafile mf_work" title="tutorial:method:technology_mapping:vme-read-csc.circuit.work (3.6 KB)">vme-read-csc.circuit.work</a> (4 KiB)</span>  </td>
	</tr>
</table></div>
</div>
<p>
This circuit is not mapped yet, i.e. complex-gates are just Boolean functions of arbitrary size, e.g. they can be not implementable by any library gate. In this case, however, the <abbr title="Signal Transition Graph">STG</abbr> was tiny and all the gates in the circuit are likely to be mappable to a realistic gate library.
</p>
<div class="wrap_center wrap_round wrap_tip plugin_wrap" style="width: 90%;">
<p>
Workcraft provides several gate libraries in the <em>SIS genlib</em> format, and the user can easily add a new library. 
The default library is <code>workcraft.lib</code>, and this library will be used below. However, it is possible to tell Workcraft to use another library by amending the <em>Gate library for technology mapping</em> setting in the <em>Edit→Preferences…</em> window under the <em>Models→Digital Circuit</em> leaf. 
See the <a href="../../../help/genlib.html" class="wikilink1" title="help:genlib" data-wiki-id="help:genlib">SIS Genlib help topic</a> for more information on the library file format.  
</p>
</div>
<p>
Complex-gate and standard-C syntheses are oblivious to the gate library – the implementations they yield are Boolean functions of arbitrary complexity. These functions are often too large to be implemented by a single gate available in the gate library. Unfortunately, breaking up a complex-gate into smaller ones, when performed naïvely, generally yields an incorrect circuit – this happens due to the delays associated with the outputs of the newly introduced gates. To illustrate this problem, suppose the gate library only has gates with up to two inputs. One may try to break up the 3-input gate implementing <code><span style='color:green; '>csc</span></code> in the above circuit into a 2-input bubble-OR gate followed by a 2-input AND, as shown below, which would preserve the Boolean function computed by the gate.
</p>
<div class="wrap_center plugin_wrap"><div class="table sectionedit17"><table class="inline">
	<tr class="row0">
		<td class="col0"> <div class="wrap_center wrap_round wrap_alert plugin_wrap">
<p>
 <img src="vme-read-csc-naive.circuit.svg" width="271" height="146" class="svgscaleinsert mediacenter" alt="tutorial:method:technology_mapping:vme-read-csc-naive.circuit.svg"> 
</p>
</div></td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  Naïve decomposition of <code><span style='color:green; '>csc</span></code> signal<br/>
<span class="wrap_download "><a href="vme-read-csc-naive.circuit.work" class="media mediafile mf_work" title="tutorial:method:technology_mapping:vme-read-csc-naive.circuit.work (3.8 KB)">vme-read-csc-naive.circuit.work</a> (4 KiB)</span>  </td>
	</tr>
</table></div>
</div>
<p>
This can be done by right-clicking this gate and selecting <em>Split multi-level gate</em> from the pop-up menu. (Alternatively use <em>Transformation→Split multi-level gates (selected or all)</em> menu.) Unfortunately, the new delay associated with the output of bubble-OR gate breaks the speed-independence of the circuit, and it no longer satisfies the conformation and output persistency properties in the <em>Verification</em> menu. Simulate the violation traces to understand why the decomposed circuit fails, even though the original circuit was correct.
</p>

<p>
Let us now try automatic decomposition. First, we need to restrict the default library to 2-input gates: In the <em>Edit→Preferences</em> dialog, select <em>External tools→MPSat synthesis</em> and tick the <em>Edit additional parameters before every call</em> checkbox. Then select <em>Synthesis→Technology mapping [MPSat]</em>. A dialog box will pop up asking for extra command line parameters to pass to MPSat – type <code>-g2</code> to restrict MPSat to gates/latches with at most two inputs (see <a href="../../../help/backend/mpsat.html" class="wikilink1" title="help:backend:mpsat" data-wiki-id="help:backend:mpsat">MPSat command line options</a> for details). The following circuit (the layout was manually improved) can then be synthesised (<span class="wrap_important ">note that solution is not unique and you may get a slightly different one</span>).
</p>
<div class="wrap_center plugin_wrap"><div class="table sectionedit22"><table class="inline">
	<tr class="row0">
		<td class="col0"> <img src="vme-read-csc-mapped-celement.circuit.svg" width="271" height="152" class="svgscaleinsert mediacenter" alt="tutorial:method:technology_mapping:vme-read-csc-mapped-celement.circuit.svg"> </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  Technology mapping into 2-input gates<br/>
<span class="wrap_download "><a href="vme-read-csc-mapped-celement.circuit.work" class="media mediafile mf_work" title="tutorial:method:technology_mapping:vme-read-csc-mapped-celement.circuit.work (3.8 KB)">vme-read-csc-mapped-celement.circuit.work</a> (4 KiB)</span>  </td>
	</tr>
</table></div>
</div>
<p>
The circuit is now mapped – the gate labels correspond to the gate names in the library. Interestingly, MPSat replaced the 3-input gate with feedback by a latch. In fact, this replacement is not equivalent in the Boolean sense – there is a difference when <code><span style='color:red; '>dsr</span></code>=<code><span style='color:red; '>ldtack</span></code>=0 and <code><span style='color:green; '>csc</span></code>=1; however, no such state is reachable, so this implementation is correct – this can (and should!) be formally verified using <em>Verification</em> menu.
</p>
<div class="wrap_center wrap_round wrap_tip plugin_wrap" style="width: 90%;">
<p>
It is impossible to find this mapping by considering only the original complex-gate circuit, as the set of reachable states depends on both, the circuit and its environment, and the behaviour of the environment cannot be deduced from the circuit. Hence the <abbr title="Signal Transition Graph">STG</abbr> (representing the contract between the circuit and its environment) plays a crucial role in asynchronous synthesis.
</p>
</div><div class="wrap_center wrap_round wrap_tip plugin_wrap" style="width: 90%;">
<p>
Note that the inverter at the input of the C-element has a dotted line through, indicating that there is a zero delay assumption on it, i.e. it must be placed next to the C-element and its worst-case delay should be smaller then any other gate delay. This is usually unproblematic as long as such input inverters are placed next to the main gate, but in some situations this assumption may be questionable; moreover, this assumption introduces extra constraints that have to be satisfied during placing and routing. In this case this assumption is actually superfluous: select this inverter, un-tick the <em>Zero delay</em> checkbox in the Property editor, and verify the resulting circuit. This can be done automatically, via the <em>Transformation → Optimise zero delay of buffers and inverters (selected or all)</em> menu item.
</p>
</div>
<p>
In this particular case no logic decomposition was necessary – the library happened to have a latch that would directly (with an extra inverter) implement <code><span style='color:green; '>csc</span></code>. Let us now restrict the library to 2-input gates and no latches, to force MPSat perform logic decomposition. Select <em>Synthesis→Technology mapping [MPSat]</em> and a dialog box will pop up asking for extra command line parameters to pass to MPSat – type <code>-g!2</code> (see <a href="../../../help/backend/mpsat.html" class="wikilink1" title="help:backend:mpsat" data-wiki-id="help:backend:mpsat">MPSat command line options</a> for details). The following circuit (the layout was manually improved) can then be synthesised (<span class="wrap_important ">note that solution is not unique and you may get a slightly different one</span>).
</p>
<div class="wrap_center plugin_wrap"><div class="table sectionedit29"><table class="inline">
	<tr class="row0">
		<td class="col0"> <img src="vme-read-csc-mapped-2input.circuit.svg" width="365" height="241" class="svgscaleinsert mediacenter" alt="tutorial:method:technology_mapping:vme-read-csc-mapped-2input.circuit.svg"> </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  Technology mapping into 2-input combinational gates<br/>
<span class="wrap_download "><a href="vme-read-csc-mapped-2input.circuit.work" class="media mediafile mf_work" title="tutorial:method:technology_mapping:vme-read-csc-mapped-2input.circuit.work (4 KB)">vme-read-csc-mapped-2input.circuit.work</a> (4 KiB)</span>  </td>
	</tr>
</table></div>
</div>
<p>
This time the 3-input gate was decomposed into two 2-input gates, i.e. logic decomposition did occur. This decomposition resembles (after reshuffling the bubbles) the incorrect naïve one described above, but in fact there is an important difference: The output of the leftmost gate is now forked, so each transition of this gate is <em>acknowledged</em> by (i.e. causes) a transition on one of the two gates it is driving. The principle that each signal transition must be acknowledged is fundamental for speed-independent circuits, and its violation in the naïve design described above was indicative of its incorrectness.
</p>
<div class="wrap_center wrap_round wrap_important plugin_wrap" style="width: 90%;">
<p>
Do not forget to un-tick the <em>Edit additional parameters before every call</em> checkbox (unless you want to be prompted for extra parameters every time MPSat synthesis is invoked).
</p>
</div>
</div>

<h2 id="overcoming_technology_mapping_failure">Overcoming technology mapping failure</h2>
<div class="level2">

<p>
As was already explained above, technology mapping in the context of asynchronous circuits is a difficult problem, and the tools occasionally fail to solve it. This section describes several techniques and tricks for overcoming this problem.
</p>

</div>

<h3 id="hierarchical_design">Hierarchical design</h3>
<div class="level3">
<div class="wrap_center wrap_round wrap_tip plugin_wrap" style="width: 50%;">
<p>
An ounce of prevention is worth a pound of cure!
</p>
</div>
<p>
A common mistake of novice designers is to attempt creating a single large monolithic <abbr title="Signal Transition Graph">STG</abbr> capturing the behaviour of the whole system. The complexity of technology mapping (and of everything else) can be significantly reduced if one acts early on and uses <em>hierarchical decomposition</em> of a complex design into smaller modules (communicating e.g. by handshakes), which are decomposed into even smaller modules, etc., until the terminal modules are small enough (e.g. have only a handful of signals – if a module has more than 10-12 signals it usually should be decomposed). As an example, consider the following hierarchy for a single phase of a multi-phase buck controller <a href="#refnotes:1:note1" name="refnotes:1:ref1" class="refnotes-ref note-popup">[1]</a>:
</p>

<p>
<img src="phase-tm.circuit.svg" width="964" height="517" class="svgscaleinsert mediacenter" alt="tutorial:method:technology_mapping:phase-tm.circuit.svg">
</p>

<p>
The following tutorials illustrate this approach:
</p>
<ul>
<li class="level1"><div class="li"> <a href="../../design/hierarchical_buck/start.html" class="wikilink1" title="tutorial:design:hierarchical_buck:start" data-wiki-id="tutorial:design:hierarchical_buck:start">Hierarchical design of a realistic buck controller</a>.</div>
</li>
<li class="level1"><div class="li"> <a href="../hierarchical_design/start.html" class="wikilink1" title="tutorial:method:hierarchical_design:start" data-wiki-id="tutorial:method:hierarchical_design:start">Verification and synthesis of hierarchical designs</a>.</div>
</li>
</ul>

<p>
The hierarchical approach has a number of important advantages:
</p>
<ul>
<li class="level1"><div class="li"> Hierarchical designs are easier to comprehend, document, explain to other people, and maintain. <del>They also look better on PowerPoint slides.</del></div>
</li>
<li class="level1"><div class="li"> Designing several small STGs is almost always simpler than designing a large monolithic one – and also reduces the risk that the <abbr title="Signal Transition Graph">STG</abbr> does something unexpected.</div>
</li>
<li class="level1"><div class="li"> It is often the case that some of the modules can be re-used within a design (or even by different designs); hierarchical approach helps identifying such reusable components.</div>
</li>
<li class="level1"><div class="li"> Hierarchical design avoids creating large monolithic STGs, which are difficult for the tools to synthesise. It should be stressed that if one sets out to create a large monolithic <abbr title="Signal Transition Graph">STG</abbr>, technology mapping is almost certainly will be a major challenge.</div>
</li>
</ul>

<p>
Partitioning a module into smaller ones in a meaningful way is a creative problem. A possible approach could be:
</p>
<ul>
<li class="level1"><div class="li"> Think of the output signals of the module as “what the module computes”.</div>
</li>
<li class="level1"><div class="li"> Partition the output signals into two (or more) sets – hopefully, in a meaningful way, so that “related” outputs are kept together; from each of these sets a new sub-module will be created.</div>
</li>
<li class="level1"><div class="li"> The set of signals in each sub-module has to be iteratively expanded by including any signal that triggers or is in the choice relationship with an already included output signal. (Choices involving outputs violate output persistency, so it&#039;s mostly about keeping a mutex&#039;s outputs in the same module.) The triggering signals become inputs of the module: It is ok to share the module inputs between several sub-modules, and an output of one sub-module could be an input of 0 or more other sub-modules, but no signal can be an output of more than one sub-module.</div>
</li>
<li class="level1"><div class="li"> If you had to include all (or most) outputs of one sub-module into another, you may merge the former sub-module into the latter one.</div>
</li>
<li class="level1"><div class="li"> Some extra communication between the sub-modules may be required, e.g. new handshakes. If several modules form a token ring, it may be possible to use one signal per link rather than a handshake, e.g. see the example in <a href="../hierarchical_design/start.html" class="wikilink1" title="tutorial:method:hierarchical_design:start" data-wiki-id="tutorial:method:hierarchical_design:start">Verification and synthesis of hierarchical designs</a>.</div>
</li>
</ul>

<p>
One would wish the hierarchical approach to eliminate the problems during technology mapping, making it fully automatic. However, there are still practical situations when one has to help the tools:
</p>
<ul>
<li class="level1"><div class="li"> “I see the light and will always follow the hierarchical approach from now on, but I have several large monolithic STGs from my dark past, which must be mapped by tomorrow.”</div>
</li>
<li class="level1"><div class="li"> “I inherited a large monolithic <abbr title="Signal Transition Graph">STG</abbr> from another designer.”</div>
</li>
<li class="level1"><div class="li"> “I cannot think of any meaningful way to decompose this module.”</div>
</li>
<li class="level1"><div class="li"> “I faithfully followed the hierarchical approach, but the tools still failed on a relatively small module.”</div>
</li>
<li class="level1"><div class="li"> Etc.</div>
</li>
</ul>

<p>
The rest of this section is describing various tips and tricks which may help in such situations. There is still no guarantee of success, so the ultimate fall-back position is appealing to the designer&#039;s “high-level understanding of the system”, “creativity”, and the ability to “think outside the box”. 
</p>

</div>

<h3 id="expanding_the_gate_library">Expanding the gate library</h3>
<div class="level3">

<p>
Consider the following <abbr title="Signal Transition Graph">STG</abbr> specifying a 5-input OR function with mutually exclusive inputs:
</p>
<div class="wrap_center plugin_wrap"><div class="table sectionedit36"><table class="inline">
	<tr class="row0">
		<td class="col0"> <img src="or5.stg.svg" width="265" height="265" class="svgscaleinsert mediacenter" alt="tutorial:method:technology_mapping:or5.stg.svg"> </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  <abbr title="Signal Transition Graph">STG</abbr> for 5-input OR function<br/>
<span class="wrap_download "><a href="or5.stg.work" class="media mediafile mf_work" title="tutorial:method:technology_mapping:or5.stg.work (3.6 KB)">or5.stg.work</a> (4 KiB)</span>  </td>
	</tr>
</table></div>
</div>
<p>
The complex-gate implementation is a 5-input OR gate as expected, but Workcraft&#039;s default gate library does not have an OR5 gate, and both Petrify and MPSat fail to decompose this example. If extending the gate library is an option, one can just add an OR5 gate to it. Unfortunately, expanding the library is rarely an option. If at all possible, make sure you have at least a C-element – this opens up more logic decomposition opportunities.
</p>

</div>

<h3 id="insertion_of_helper_internal_signals">Insertion of helper internal signals</h3>
<div class="level3">

<p>
Logic decomposition is the most difficult part of the process, and technology mapping (in the narrow sense) is simple once logic decomposition succeeds in breaking up the gates into ones directly mappable to the gate library. The tools perform logic decomposition at the level of the <abbr title="Signal Transition Graph">STG</abbr>, by adding internal signals corresponding to various sub-functions of complex-gates. This process heavily relies on heuristics, so a designer can help the tool by inserting a new internal signal implementing some useful sub-function. (Tutorial <a href="../csc_resolution/start.html#signal_insertion" class="wikilink1" title="tutorial:method:csc_resolution:start" data-wiki-id="tutorial:method:csc_resolution:start">Resolution of encoding (CSC) conflicts</a> explains how to insert internal signals into an <abbr title="Signal Transition Graph">STG</abbr>.)
</p>

<p>
The reason why Petrify fails for the above <abbr title="Signal Transition Graph">STG</abbr> is unclear (probably some unlucky application of a heuristic). The reason for MPSat&#039;s failure is that it inserts signals <em>structurally</em> into the <abbr title="Signal Transition Graph">STG</abbr>, and only a restricted classes of insertions are possible, all of which happen to be not applicable to this <abbr title="Signal Transition Graph">STG</abbr>. The designer can help the tool by inserting a signal to split off a 3-input OR function, as shown below. Signal <code><span style='color:green; '>map</span></code> can then be implemented as <code>OR3(<span style='color:red; '>in1</span>,<span style='color:red; '>in2</span>,<span style='color:red; '>in3</span>)</code>, and then <code><span style='color:blue; '>out</span></code> can be implemented as <code>OR3(<span style='color:green; '>map</span>,<span style='color:red; '>in4</span>,<span style='color:red; '>in5</span>)</code>, and the tools now easily find this implementation.
</p>
<div class="wrap_center plugin_wrap"><div class="table sectionedit39"><table class="inline">
	<tr class="row0">
		<td class="col0"> <img src="or5-split.stg.svg" width="265" height="422" class="svgscaleinsert mediacenter" alt="tutorial:method:technology_mapping:or5-split.stg.svg"> </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  <abbr title="Signal Transition Graph">STG</abbr> for 5-input OR function with helper <code><span style='color:green; '>map</span></code> signal<br/>
<span class="wrap_download "><a href="or5-split.stg.work" class="media mediafile mf_work" title="tutorial:method:technology_mapping:or5-split.stg.work (3.9 KB)">or5-split.stg.work</a> (4 KiB)</span>  </td>
	</tr>
</table></div>
</div>
</div>

<h3 id="simplifying_stg_structure">Simplifying STG structure</h3>
<div class="level3">

<p>
Another important approach is to simplify the structure of the <abbr title="Signal Transition Graph">STG</abbr> by reducing the number of choice and merge places – this will help MPSat that uses structural insertions. The 5-input OR <abbr title="Signal Transition Graph">STG</abbr> above has quite a contrived structure, with several choice and merge places. The place at the top models free choice between the inputs – it is essential, so one has to keep it. The following merge place is used only to execute a single output transition, and is immediately followed by a controlled choice place, with the extra parallel arcs between input transitions to keep track of the current branch. One can simplify the structure considerably, by replicating transitions of <code><span style='color:blue; '>out</span></code>, removing also the final merge place. Note that both STGs below are semantically identical, but the one on the right uses a <em>proxy place</em> (this feature is accessible from the <em>Transformations</em> menu, or from the pop-up menu when one right-clicks an arc) to improve the layout. Now both Petrify and MPSat have no difficulty mapping this simplified <abbr title="Signal Transition Graph">STG</abbr>.
</p>
<div class="group plugin_wrap"><div class="wrap_half wrap_column wrap_center plugin_wrap"><div class="table sectionedit44"><table class="inline">
	<tr class="row0">
		<td class="col0"> <img src="or5-simple-structure.stg.svg" width="325" height="203" class="svgscaleinsert mediacenter" alt="tutorial:method:technology_mapping:or5-simple-structure.stg.svg"> </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  Simplified <abbr title="Signal Transition Graph">STG</abbr> for 5-input OR<br/>
<span class="wrap_download "><a href="or5-simple-structure.stg.work" class="media mediafile mf_work" title="tutorial:method:technology_mapping:or5-simple-structure.stg.work (4.1 KB)">or5-simple-structure.stg.work</a> (4 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_half wrap_column plugin_wrap"><div class="table sectionedit47"><table class="inline">
	<tr class="row0">
		<td class="col0"> <img src="or5-simple-structure-proxy.stg.svg" width="242" height="208" class="svgscaleinsert mediacenter" alt="tutorial:method:technology_mapping:or5-simple-structure-proxy.stg.svg"> </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  Simplified <abbr title="Signal Transition Graph">STG</abbr> for 5-input OR with a proxy place<br/>
<span class="wrap_download "><a href="or5-simple-structure-proxy.stg.work" class="media mediafile mf_work" title="tutorial:method:technology_mapping:or5-simple-structure-proxy.stg.work (4 KB)">or5-simple-structure-proxy.stg.work</a> (4 KiB)</span>  </td>
	</tr>
</table></div>
</div></div>
</div>

<h3 id="stg_re-synthesis">STG re-synthesis</h3>
<div class="level3">

<p>
<em><abbr title="Signal Transition Graph">STG</abbr> re-synthesis</em> is an automatic process involving building the state graph of the given <abbr title="Signal Transition Graph">STG</abbr> and then deriving an equivalent <abbr title="Signal Transition Graph">STG</abbr> from this state graph. This may simplify the structure of the <abbr title="Signal Transition Graph">STG</abbr>, so it is related to the above approach. Note that the resulting <abbr title="Signal Transition Graph">STG</abbr> is not necessarily the simplest possible one, e.g. for the OR5 example re-synthesis derives an <abbr title="Signal Transition Graph">STG</abbr> with two non-implicit places, which still cannot be automatically mapped. Nevertheless, when technology mapping fails, you may try to push your luck by re-synthesising the <abbr title="Signal Transition Graph">STG</abbr> and mapping the result. For example, consider the following <abbr title="Signal Transition Graph">STG</abbr> (an early version of the design in <a href="#refnotes:1:note2" name="refnotes:1:ref2" class="refnotes-ref note-popup">[2]</a> that did not make it to the paper):
</p>
<div class="wrap_center plugin_wrap"><div class="table sectionedit50"><table class="inline">
	<tr class="row0">
		<td class="col0"> <img src="master-read-write-interface.stg.svg" width="641" height="561" class="svgscaleinsert mediacenter" alt="tutorial:method:technology_mapping:master-read-write-interface.stg.svg"> </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  <abbr title="Signal Transition Graph">STG</abbr> for master module of SRAM controller<br/>
<span class="wrap_download "><a href="master-read-write-interface.stg.work" class="media mediafile mf_work" title="tutorial:method:technology_mapping:master-read-write-interface.stg.work (7.7 KB)">master-read-write-interface.stg.work</a> (8 KiB)</span>  </td>
	</tr>
</table></div>
</div>
<p>
This <abbr title="Signal Transition Graph">STG</abbr> has a rather contrived structure with many choice and merge places, and also has four dummy transitions (dummies are generally ‘difficult’ for some of the synthesis and verification tasks in Workcraft). Not surprisingly, MPSat fails to map this circuit; Petrify at first seems to succeed, but the resulting circuit has gates with disconnected pins and fails the verification (looks like a bug in the tool).
</p>

<p>
Let us try to re-synthesise this circuit, removing also the dummies. This can be done by selecting the four dummy transitions with the mouse while holding <kbd class="__keyboard">Shift</kbd>, and then choosing <em>Conversion → Net synthesis hiding selected signals and dummies [Petrify with <code>-er</code> option]</em> (the <code>-er</code> option tells the tool to create different transitions for instances of the same signal if their excitation regions in the state graph are disjoint – this often helps to simplify the structure; occasionally, a similar command without <code>-er</code> is also helpful, so you may try that as well). The resulting <abbr title="Signal Transition Graph">STG</abbr> is shown below (<span class="wrap_important " style="width: 60%;">note that you may get a slightly different one, or layout may change</span>) – its structure is much less contrived (fewer choice and merge places) and there are no dummies. Now MPSat has no difficulty completing technology mapping, and the resulting circuit passes verification, both wrt. the re-synthesised <abbr title="Signal Transition Graph">STG</abbr> and wrt. the original one (except that Workcraft complains that output persistency cannot be checked due to dummies). Note that in the Property editor one can select which <abbr title="Signal Transition Graph">STG</abbr> to use as the circuit&#039;s environment during formal verification.
</p>
<div class="wrap_center plugin_wrap"><div class="table sectionedit53"><table class="inline">
	<tr class="row0">
		<td class="col0"> <img src="master-read-write-interface-resynth.stg.svg" width="1294" height="242" class="svgscaleinsert mediacenter" alt="tutorial:method:technology_mapping:master-read-write-interface-resynth.stg.svg"> </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  Resynthesised <abbr title="Signal Transition Graph">STG</abbr> for master module of SRAM controller<br/>
<span class="wrap_download "><a href="master-read-write-interface-resynth.stg.work" class="media mediafile mf_work" title="tutorial:method:technology_mapping:master-read-write-interface-resynth.stg.work (8.3 KB)">master-read-write-interface-resynth.stg.work</a> (8 KiB)</span>  </td>
	</tr>
</table></div>
</div>
</div>

<h3 id="concurrency_reduction">Concurrency reduction</h3>
<div class="level3">

<p>
<em>Concurrency reduction</em> is another useful technique that was explained in
the <a href="../csc_resolution/start.html#concurrency_reduction" class="wikilink1" title="tutorial:method:csc_resolution:start" data-wiki-id="tutorial:method:csc_resolution:start">Resolution of encoding (CSC) conflicts</a>
tutorial. However, it can be applied not only for CSC resolution, but also for simplifying the circuit, 
which may help technology mapping. As an example, consider the control logic of 
WAITX <a href="#refnotes:1:note3" name="refnotes:1:ref3" class="refnotes-ref note-popup">[3]</a> – an element from the family of <a href="../../../help/a2a/start.html" class="wikilink1" title="a2a:start" data-wiki-id="a2a:start">Asynchronous Arbitration Primitives</a>.
</p>

<p>
The <abbr title="Signal Transition Graph">STG</abbr> for this controller is shown below – note that internal signal <code><span style='color:green; '>csc</span></code>
and two concurrency reductions (the amber arcs) were used to solve the CSC conflicts. The complex-gate 
implementation has gates with up to eight inputs. Even though automatic technology mapping succeeds, 
the resulting circuit is not particularly good – the circuit&#039;s area is large 
(220 units for MPSat and 228 for Petrify – you may get different results), with several large gates.
</p>
<div class="wrap_center plugin_wrap"><div class="table sectionedit56"><table class="inline">
	<tr class="row0">
		<td class="col0"> <img src="waitx.stg.svg" width="501" height="274" class="svgscaleinsert mediacenter" alt="tutorial:method:technology_mapping:waitx.stg.svg"> </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  <abbr title="Signal Transition Graph">STG</abbr> for WAITX with resolved CSC conflicts<br/>
<span class="wrap_download "><a href="waitx.stg.work" class="media mediafile mf_work" title="tutorial:method:technology_mapping:waitx.stg.work (6 KB)">waitx.stg.work</a> (6 KiB)</span>  </td>
	</tr>
</table></div>
</div>
<p>
The following <abbr title="Signal Transition Graph">STG</abbr> shows how to add two more concurrency reductions – the “high-level understanding of the design” allows one to conclude that these concurrency reductions are unlikely to harm the performance. The modified <abbr title="Signal Transition Graph">STG</abbr> turns out to be much easier to map and the circuit is better (the area is 156 units for MPSat and 152 for Petrify – you may get different results) with much smaller gates (the circuit in <a href="#refnotes:1:note3" name="refnotes:1:ref4" class="refnotes-ref note-popup">[3]</a> was then slightly improved manually).
</p>
<div class="wrap_center plugin_wrap"><div class="table sectionedit59"><table class="inline">
	<tr class="row0">
		<td class="col0"> <img src="waitx-cr.stg.svg" width="536" height="291" class="svgscaleinsert mediacenter" alt="tutorial:method:technology_mapping:waitx-cr.stg.svg"> </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  <abbr title="Signal Transition Graph">STG</abbr> for WAITX simplified by concurrency reduction<br/>
<span class="wrap_download "><a href="waitx-cr.stg.work" class="media mediafile mf_work" title="tutorial:method:technology_mapping:waitx-cr.stg.work (6.2 KB)">waitx-cr.stg.work</a> (6 KiB)</span>  </td>
	</tr>
</table></div>
</div>
</div>

<h3 id="stg_decomposition">STG decomposition</h3>
<div class="level3">

<p>
Occasionally one has no choice but re-designing the given large <abbr title="Signal Transition Graph">STG</abbr> as a composition of smaller ones, as described in the <a href="start.html#hierarchical_design" class="wikilink1" title="tutorial:method:technology_mapping:start" data-wiki-id="tutorial:method:technology_mapping:start">Hierarchical design</a> section above. This is a creative process that requires deep understanding of the design, though <a href="https://github.com/hpiasg/desij" class="urlextern" title="https://github.com/hpiasg/desij" rel="ugc nofollow">DesiJ</a> tool can assist the designer, and even automatically create a set of mappable sub-modules in some lucky cases.
</p>

</div>

<h3 id="non-speed-independent_decomposition_with_relative_timing_assumptions">Non-speed-independent decomposition with relative timing assumptions</h3>
<div class="level3">

<p>
If the approaches outlined above fail or not applicable, one can map the circuit by doing non-speed-independent decomposition, and rely on timing to guarantee correctness. <em>Relative timing assumptions (RTA)</em> were explained in the <a href="../csc_resolution/start.html#relative_timing_assumptions" class="wikilink1" title="tutorial:method:csc_resolution:start" data-wiki-id="tutorial:method:csc_resolution:start">Resolution of encoding (CSC) conflicts</a> tutorial. 
</p>
<div class="wrap_center wrap_round wrap_important plugin_wrap" style="width: 90%;">
<p>
RTAs can be a real help, but they do require a lot of care as it is easy to make a mistake, and they have to be taken into account at the place-and-route stage of the circuit design.
</p>
</div>
<p>
For example, let us re-consider the naïve decomposition of the VME bus controller introduced above:
</p>
<div class="wrap_center wrap_round wrap_alert plugin_wrap" style="width: 90%;">
<p>
<img src="vme-read-csc-naive.circuit.svg" width="271" height="146" class="svgscaleinsert mediacenter" alt="tutorial:method:technology_mapping:vme-read-csc-naive.circuit.svg">
</p>
</div>
<p>
This decomposition is not speed-independent, i.e. various correctness properties will be violated <em>under certain gate delays,</em> in particular if the gate implementing <code><span style='color:green; '>x</span></code> is <em>relatively</em> slow (or there is a long wire from it to gate <code><span style='color:green; '>csc</span></code>). However, it may be possible to eliminate all the violations by ensuring that the gate delays are such that no violation trace can happen due to timing, in this case by ensuring that <code><span style='color:green; '>x</span></code> is <em>relatively</em> fast. Indeed, this design was obtained from a correct complex-gate implementation by splitting an atomic 3-input gate implementing <code><span style='color:green; '>csc</span></code> into two 2-input gates, <code><span style='color:green; '>x</span></code> and <code><span style='color:green; '>csc</span></code>, and the violations are due to the new delay associated with gate <code><span style='color:green; '>x</span></code> – this delay did not exist when the corresponding sub-function was inside the 3-input complex-gate regarded as atomic. Intuitively, if this delay is sufficiently short (e.g. shorter than the shortest possible delay of any other gate in the circuit, though less stringent constraints can often be derived by careful analysis), the two gates will behave as a single atomic complex-gate. This consideration motivates the use of zero delay inverters – these are usually the fastest gates in the library, but one has still to be careful and place them next to the main gate. However, for more complicated gates careful timing analysis is necessary to derive less stringent RTAs, e.g. for this circuit one can show that the following two RTAs are sufficient to guarantee its correctness:
</p>
<pre class="code">MaxDelay(x-) &lt; MinDelay(d- → lds-)
MaxDelay(x-) &lt; MinDelay(d- → dtack- → dsr+)</pre>

<p>
Note that timing analysis required to obtain these constraints is non-trivial and is beyond the scope of this tutorial.
</p>

</div>

<h2 id="solutions">Solutions</h2>
<div class="level2">

<p>
Download all the Workcraft models discussed in this tutorial here:
</p>

<p>
<span class="wrap_download "><a href="tech_mapping.zip" class="media mediafile mf_zip" title="tutorial:method:technology_mapping:tech_mapping.zip (61.9 KB)">Models for technology mapping</a> (62 KiB)</span>
</p>

</div>
<div class="level1">
<div class="plugin_include_content plugin_include__tutorial:feedback" id="plugin_include__tutorial__feedback">
<div class="wrap_hide plugin_wrap"><pre class="code">===== Feedback =====</pre>
<form class="bureaucracy__plugin" id="bureaucracy__plugin1" enctype="multipart/form-data" method="post" action="start.html" accept-charset="utf-8"><div class="no">
<input type="hidden" name="sectok" value="f9e2bfe14be3555a5d08b7b3937392ae" /><input type="hidden" name="id" value="tutorial:method:technology_mapping:start" /><input type="hidden" name="bureaucracy[$$id]" value="1" /><fieldset ><legend>Comments or suggestions for improving this tutorial</legend>
<label><span>Name (optional)</span> <input type="text" name="bureaucracy[1]" class="edit" /></label>
<label><span>Email (optional)</span> <input type="text" name="bureaucracy[2]" class="edit" /></label>
<label class=" textareafield">
    <span>Feedback <sup>*</sup></span>
    <textarea name="bureaucracy[3]" id="" rows="10" cols="10" class="edit required&quot; required=&quot;required"></textarea>
</label><button type="submit">Submit</button>
</fieldset>
</div></form>
</div><div class="wrap_hide plugin_wrap"><ul>
<li class="level1"><div class="li"> As discussed in <a href="https://www.dokuwiki.org/plugin:include#controlling_header_size_in_included_pages" class="urlextern" title="https://www.dokuwiki.org/plugin:include#controlling_header_size_in_included_pages" rel="ugc nofollow">https://www.dokuwiki.org/plugin:include#controlling_header_size_in_included_pages</a>, by default, the headers in included pages start one level lower than the last header in the current page. This can be tweaked by adding an empty header above the include:\\<pre class="code">====== ======
{{page&gt;:tutorial:feedback&amp;inline}}</pre>
</div>
</li>
<li class="level1"><div class="li"> For offline help generation the content of <code>feedback</code> page should be temporary wrapped in <code>&lt;WRAP hide&gt;</code>. Note that the headers still propagate to the table of contents even if inside the hidden wrap. Therefore the <strong>Feedback</strong> title needs to be converted to something else, e.g. to code by adding two spaces in front.</div>
</li>
</ul>
</div></div>







</div>
<div class="refnotes">
<hr>
<div class="notes">
<div class="note left">
<b><a name="refnotes:1:note1" class="nolink">[1]</a></b>
<span id="refnotes:1:note1:text">
D. Sokolov,  V. Dubikhin, V. Khomenko,  D. Lloyd,  A. Mokhov,  A. Yakovlev: <a href="https://doi.org/10.23919/DATE.2017.7927276" class="urlextern" title="https://doi.org/10.23919/DATE.2017.7927276" rel="ugc nofollow">Benefits of Asynchronous Control for Analog Electronics: Multiphase Buck Case Study</a>. Proc. DATE (2017).
</span></div>
<div class="note left">
<b><a name="refnotes:1:note2" class="nolink">[2]</a></b>
<span id="refnotes:1:note2:text">
V. Khomenko, A. Mokhov, D. Sokolov, A. Yakovlev: <a href="https://doi.org/10.1109/ACSD.2017.12" class="urlextern" title="https://doi.org/10.1109/ACSD.2017.12" rel="ugc nofollow">Formal Design and Verification of an Asynchronous SRAM Controller</a>. Proc. ACSD (2017) 59-67.
</span></div>
<div class="note left">
<b><a name="refnotes:1:note3" class="nolink">[3]</a></b>
<span id="refnotes:1:note3:text">
V. Khomenko, D. Sokolov, A. Mokhov, A. Yakovlev: <a href="http://dx.doi.org/10.1109/ASYNC.2017.8" class="urlextern" title="http://dx.doi.org/10.1109/ASYNC.2017.8" rel="ugc nofollow">WAITX: An Arbiter for Non-Persistent Signals</a>. Proc. ASYNC (2017) 33–40.
</span></div>
</div>
</div>

                    <!-- wikipage stop -->
                                    </div>
<!--
                <div class="docInfo">
                    workcraft @ <bdi>tutorial/method/technology_mapping/start.txt</bdi> · Modified 2021/04/28 15:20 by <bdi>victor</bdi>                </div>
-->
                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
<!--
            <div id="dokuwiki__pagetools">
                            <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li class="edit"><a href="start.html" title="Edit this page [e]" rel="nofollow" accesskey="e"><span>Edit this page</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg></a></li><li class="revs"><a href="start.html" title="Old revisions [o]" rel="nofollow" accesskey="o"><span>Old revisions</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M11 7v5.11l4.71 2.79.79-1.28-4-2.37V7m0-5C8.97 2 5.91 3.92 4.27 6.77L2 4.5V11h6.5L5.75 8.25C6.96 5.73 9.5 4 12.5 4a7.5 7.5 0 0 1 7.5 7.5 7.5 7.5 0 0 1-7.5 7.5c-3.27 0-6.03-2.09-7.06-5h-2.1c1.1 4.03 4.77 7 9.16 7 5.24 0 9.5-4.25 9.5-9.5A9.5 9.5 0 0 0 12.5 2z"/></svg></a></li><li class="backlink"><a href="start.html" title="Backlinks" rel="nofollow"><span>Backlinks</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M10.59 13.41c.41.39.41 1.03 0 1.42-.39.39-1.03.39-1.42 0a5.003 5.003 0 0 1 0-7.07l3.54-3.54a5.003 5.003 0 0 1 7.07 0 5.003 5.003 0 0 1 0 7.07l-1.49 1.49c.01-.82-.12-1.64-.4-2.42l.47-.48a2.982 2.982 0 0 0 0-4.24 2.982 2.982 0 0 0-4.24 0l-3.53 3.53a2.982 2.982 0 0 0 0 4.24m2.82-4.24c.39-.39 1.03-.39 1.42 0a5.003 5.003 0 0 1 0 7.07l-3.54 3.54a5.003 5.003 0 0 1-7.07 0 5.003 5.003 0 0 1 0-7.07l1.49-1.49c-.01.82.12 1.64.4 2.43l-.47.47a2.982 2.982 0 0 0 0 4.24 2.982 2.982 0 0 0 4.24 0l3.53-3.53a2.982 2.982 0 0 0 0-4.24.973.973 0 0 1 0-1.42z"/></svg></a></li><li class="export_pdf"><a href="start.html" title="Export to PDF" rel="nofollow"><span>Export to PDF</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M14 9h5.5L14 3.5V9M7 2h8l6 6v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m4.93 10.44c.41.9.93 1.64 1.53 2.15l.41.32c-.87.16-2.07.44-3.34.93l-.11.04.5-1.04c.45-.87.78-1.66 1.01-2.4m6.48 3.81c.18-.18.27-.41.28-.66.03-.2-.02-.39-.12-.55-.29-.47-1.04-.69-2.28-.69l-1.29.07-.87-.58c-.63-.52-1.2-1.43-1.6-2.56l.04-.14c.33-1.33.64-2.94-.02-3.6a.853.853 0 0 0-.61-.24h-.24c-.37 0-.7.39-.79.77-.37 1.33-.15 2.06.22 3.27v.01c-.25.88-.57 1.9-1.08 2.93l-.96 1.8-.89.49c-1.2.75-1.77 1.59-1.88 2.12-.04.19-.02.36.05.54l.03.05.48.31.44.11c.81 0 1.73-.95 2.97-3.07l.18-.07c1.03-.33 2.31-.56 4.03-.75 1.03.51 2.24.74 3 .74.44 0 .74-.11.91-.3m-.41-.71l.09.11c-.01.1-.04.11-.09.13h-.04l-.19.02c-.46 0-1.17-.19-1.9-.51.09-.1.13-.1.23-.1 1.4 0 1.8.25 1.9.35M8.83 17c-.65 1.19-1.24 1.85-1.69 2 .05-.38.5-1.04 1.21-1.69l.48-.31m3.02-6.91c-.23-.9-.24-1.63-.07-2.05l.07-.12.15.05c.17.24.19.56.09 1.1l-.03.16-.16.82-.05.04z"/></svg></a></li><li class="menuitemfolded"><a href="javascript:void(0);" title="Fold/unfold all" rel="nofollow" class="fold_unfold_all_new" onclick="fold_unfold_all();"><span>Fold/unfold all</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M 2,0 L 6.5,3 L 2,6 z M 8,6.6 L 12.5,9.6 L 8,12.6 z M 14,13.2 L 20,13.2 L 17,17.7 z"/></svg></a></li><li class="menuitem"><a href="start.html" title="Rename Page" rel="nofollow" class=" plugin_move_page "><span>Rename Page</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M18,4V3A1,1 0 0,0 17,2H5A1,1 0 0,0 4,3V7A1,1 0 0,0 5,8H17A1,1 0 0,0 18,7V6H19V10H9V21A1,1 0 0,0 10,22H12A1,1 0 0,0 13,21V12H21V4H18Z" /></svg></a></li><li class="siteexport_addpage"><a href="start.html" title="Export Page to HTML/PDF" rel="nofollow"><span>Export Page to HTML/PDF</span><svg width="61px" height="51px" viewBox="0 0 61 51" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><path d="M26.1891503,39.0065635 L26.0876578,38.9773206 L60.6523866,1.23972885 L60.4321374,2.11844376 L60.476442,2.07071678 L60.4265202,2.14085429 L49.5024876,45.7237994 L32.8255882,40.9187101 L26,50.508302 L26,39.2103249 L26.1891503,39.0065635 Z M60.9727675,0.862917243 L22.2676619,38.2155059 L-0.00245042233,30.2214566 L60.9727675,0.862917243 Z" id="Paper-Plane"></path></svg></a></li><li class="top"><a href="#dokuwiki__top" title="Back to top [t]" rel="nofollow" accesskey="t"><span>Back to top</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg></a></li>                    </ul>
                </div>
                        </div>
-->
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<!--
<div id="dokuwiki__footer"><div class="pad">
    
    <div class="buttons">
                <a href="https://www.dokuwiki.org/donate" title="Donate" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="https://php.net" title="Powered by PHP" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="../../check/referer" title="Valid HTML5" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="../../css-validator/check/referer.fe4c581d16fb9f59f07485ddb441e467" title="Valid CSS" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="https://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-dw.png" width="80" height="15"
            alt="Driven by DokuWiki" /></a>
    </div>
</div></div>
-->
    </div></div><!-- /site -->

    <div class="no"><img src="../../lib/exe/taskrunner.85fe886cf0f8bcef20b540e2b184364b.gif" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div></body>
</html>
